#!/usr/bin/python

import json
import requests
import sys

if len(sys.argv) > 1:
    word = sys.argv[1]
    api_url = f"https://api.dictionaryapi.dev/api/v2/entries/en/{word}"

    req = requests.get(api_url)

    if not req.status_code == 200:
        print("error: code", req.status_code)
        sys.exit(1)

    req_text = req.text
    res = json.loads(req_text)[0]

    meanings = res["meanings"]

    print(f"word: {word}")

    for meaning in meanings:
        part_of_speech = meaning["partOfSpeech"]
        definitions = meaning["definitions"]

        print(part_of_speech)
        for definition in definitions:
            d = definition["definition"]
            s = definition["synonyms"]
            a = definition["antonyms"]

            print(f"\t- {d}".expandtabs(2))

            if s:
                syns = ", ".join(s)
                syns = f"synonyms: {syns}"
                print(f"\t{syns}".expandtabs(4))

            if a:
                ants = ", ".join(a)
                ants = f"antonyms: {ants}"
                print(f"\t{ants}".expandtabs(4))

else:
    print("usage: dictlookup <word>")
    sys.exit(1)
