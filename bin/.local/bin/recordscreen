#!/bin/sh

file="$HOME/screencast-$(date '+%y%m%d-%H%M-%S').mp4"

ffmpeg -y \
    -f x11grab \
    -framerate 60 \
    -s "$(xdpyinfo | awk '/dimensions/ {print $2;}')" \
    -i "$DISPLAY" \
    -f alsa -i default \
    -r 30 \
    -c:v h264 -crf 0 -preset ultrafast -c:a aac \
    "$file"

ffmpeg -i "$file" -i "$file" -map 0:v -map 1:a -c copy "${file/.mp4/-synced.mp4}"

echo "Recorded to ${file/.mp4/-synced.mp4}"
